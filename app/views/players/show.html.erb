<div class="d-flex flex-row justify-content-between align-items-start">
  <h1><%= @player.name %></h1>
</div>
<hr class="hr">


<% if @player.credits > 0 %>
  <h3 class="mb-3"> Credits Remaining: <%= @player.credits %></h3>
<% else %>
  <h3><%= ApplicationHelper.strip_trailing_zero @player.get_point_total.round(2) %> Points</h3>
<% end %>

<hr class="hr">
<div class="mb-3">
  <h4>Shares</h4>
  <% unless current_user.player == @player || @tourny_started %>
    <div>Hidden until June 14th</div>
  <% else %>
    <table class="table">
      <% if @shares.count > 0 %>
        <thead>
          <tr>
            <th scope="col">Team</th>
            <th scope="col">Shares</th>
            <th scope="col">Equity</th>
            <% unless @tourny_started %>
              <th scope="col">Actions</th>
            <% else %>
              <th scope="col">Points Earned</th>
            <% end %>
          </tr>
        </thead>
        <tbody>
          <% @shares.each do |share| %>
          <tr>
            <td><%= link_to share.team.name, share.team %></td>
            <td><%= share.amount %></td>
            <td><%= ApplicationHelper.strip_trailing_zero share.player_stake_percent.round(2) %>%</td>
            <td>
              <% unless @tourny_started %>
                <%= form_with model: share, method: :delete, url: share_path(share), data: { confirm: 'Are you sure?' } do |form| %>
                  <%= form.submit 'Delete', class: 'btn btn-danger' %>
                <% end %>
              <% else %>
                + <%= ApplicationHelper.strip_trailing_zero  share.player_points.round(2) %>
              <% end %>
            </td>
          </tr>
          <% end %>
        </tbody>        
      <% else %>
        <div >No Shares Invested</div>
      <% end %>
    </table>
  <% end %>
  
</div>

<% if @player == current_user.player && @tourny_started %>
  <div class="container text-bg-light p-3">
    <h5>Invest</h5>
    <%= form_with url: "/invest", method: :post do |form| %>
      <div class="mb-3">
        <%= form.hidden_field :player, value: @player.id %><br>

        <%= form.label :team, {}, class: "form-label" %><br>
        <%= form.select :team, @teams.map{|team| [team.name, team.id]}, {}, class: "form-select" %><br>

        <%= form.label :amount, {}, class: "form-label"  %><br>
        <%= form.select :amount, [10, 20, 30, 40, 50], {}, class: "form-select" %>
      </div>

      <div>
        <%= form.submit %>
      </div>
    <% end %>
  </div>
<% end %>
